import psi4
import numpy as np
np.set_printoptions(precision=12, linewidth=400)

basis {
assign one_s_orb
[ one_s_orb ]
cartesian
****
H     0
S   1   1.00
      0.50000000000      1.0000000000
S   1   1.00
      0.40000000000      1.0000000000
****
}

molecule h2o {
symmetry c1
units bohr
0 1
H 0.000000000000 0.000000000000 -0.849220457955
H 0.000000000000 0.000000000000 0.849220457955
}

set diis false
set scf_type pk
set puream false
set e_convergence 12
set d_convergence 12
e, wfn = gradient('hf', return_wfn=True)
print(wfn.energy())
print(np.asarray(wfn.gradient()))
mol = wfn.molecule()
bs = wfn.basisset()
basis = psi4.core.BasisSet.build(mol)
mints = psi4.core.MintsHelper(basis) 
D = np.asarray(wfn.Da())
np.save('D', D)
np.save('T', np.asarray(mints.ao_kinetic()))
np.save('V', np.asarray(mints.ao_potential()))
np.save('S', np.asarray(mints.ao_overlap()))
np.save('G', np.asarray(mints.ao_eri()))
S = mints.ao_overlap()
S.power(-0.5,1e-15)
np.save('A', S)


